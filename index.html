<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legal Text to Table Converter - Advanced</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container-fluid mt-4 mb-5">
        <h1 class="mb-4">
            <i class="fas fa-gavel"></i> Legal Text to Table Converter
            <small class="text-muted">(Nepali & English)</small>
        </h1>
        
        <!-- Input Section -->
        <div class="card mb-4" id="inputSection">
            <div class="card-body">
                <label class="form-label fw-bold">
                    <i class="fas fa-file-alt"></i> Paste Legal Text (Nepali or English):
                </label>
                <textarea id="legalText" class="form-control font-monospace" rows="12" 
                    placeholder="Paste your legal text here... (Supports both Nepali and English)"></textarea>
                <div class="mt-3 d-flex flex-wrap gap-2">
                    <button class="btn btn-primary" onclick="generateTable()" title="Process the legal text and generate table">
                        <i class="fas fa-table"></i> Generate Table
                    </button>
                    <button class="btn btn-secondary" onclick="loadSampleNepali()" title="Load sample Nepali legal text">
                        <i class="fas fa-file-import"></i> Load Sample (Nepali)
                    </button>
                    <button class="btn btn-secondary" onclick="loadSampleEnglish()" title="Load sample English legal text">
                        <i class="fas fa-file-import"></i> Load Sample (English)
                    </button>
                    <button class="btn btn-outline-secondary" onclick="clearInput()" title="Clear input textarea">
                        <i class="fas fa-eraser"></i> Clear Input
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Search & Filter Panel -->
        <div class="filter-panel" id="filterPanel">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="mb-0">
                    <i class="fas fa-search"></i> Search & Filter
                    <span class="badge bg-info ms-2" id="activeFilterCount" style="display:none;">0</span>
                </h5>
                <button class="btn btn-sm btn-outline-secondary" id="toggleFilterBtn" onclick="toggleFilterPanel()" title="Collapse or expand filter panel">
                    <i class="fas fa-chevron-up"></i> Collapse
                </button>
            </div>
            
            <div id="filterContent">
                <!-- Row Numbering Customization -->
                <div class="mb-3 p-3 bg-light rounded">
                    <div class="d-flex align-items-center gap-3">
                        <div class="flex-grow-1">
                            <label class="form-label fw-bold mb-1">
                                <i class="fas fa-hashtag"></i> Row Numbering Start Position:
                            </label>
                            <div class="input-group" style="max-width: 250px;">
                                <input type="number" id="rowStartPosition" class="form-control" value="1" min="0" step="1" title="Starting row number for numbering">
                                <button class="btn btn-info" onclick="applyRowStartPosition()" title="Apply the row start position">
                                    <i class="fas fa-check"></i> Apply
                                </button>
                            </div>
                            <small class="form-text text-muted d-block mt-1">Enter the number to start row numbering from (e.g., 0, 1, 10, 100)</small>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <!-- Search Section -->
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Search:</label>
                        <div class="input-group mb-3">
                            <input type="text" id="searchInput" class="form-control" 
                                placeholder="Search text..." onkeyup="debounceSearch()">
                            <button class="btn btn-outline-secondary dropdown-toggle" type="button" 
                                data-bs-toggle="dropdown" title="Configure search options">
                                <i class="fas fa-cog"></i>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><h6 class="dropdown-header">Search In:</h6></li>
                                <li><label class="dropdown-item"><input type="checkbox" checked id="searchText"> Text</label></li>
                                <li><label class="dropdown-item"><input type="checkbox" id="searchIDNo"> IDNo</label></li>
                                <li><label class="dropdown-item"><input type="checkbox" id="searchRemark"> Remark</label></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><h6 class="dropdown-header">Match Options:</h6></li>
                                <li><label class="dropdown-item"><input type="checkbox" id="caseSensitive"> Case Sensitive</label></li>
                                <li><label class="dropdown-item"><input type="checkbox" id="wholeWord"> Whole Word</label></li>
                                <li><label class="dropdown-item"><input type="checkbox" id="regexSearch"> Regex Pattern</label></li>
                            </ul>
                            <button class="btn btn-primary" onclick="performSearch()" title="Execute search">
                                <i class="fas fa-search"></i>
                            </button>
                            <button class="btn btn-outline-danger" onclick="clearSearch()" title="Clear search results">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div id="searchResults" class="text-muted small"></div>
                    </div>
                    
                    <!-- Filter Section -->
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Filters:</label>
                        <div class="mb-3">
                            <div class="btn-group w-100" role="group">
                                <button type="button" class="btn btn-outline-primary" data-bs-toggle="dropdown" title="Add IDNo pattern filters">
                                    <i class="fas fa-hashtag"></i> IDNo Pattern
                                </button>
                                <ul class="dropdown-menu">
                                    <li><h6 class="dropdown-header">By IDNo Pattern</h6></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('idno_main'); return false;">Main Sections (X.0)</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('idno_sub'); return false;">Subsections (X.Y)</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('idno_clause'); return false;">Clauses (X.Y.a)</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('idno_proviso'); return false;">Provisos (.P)</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('idno_explanation'); return false;">Explanations (.E)</a></li>
                                </ul>
                                
                                <button type="button" class="btn btn-outline-primary" data-bs-toggle="dropdown" title="Filter by content type">
                                    <i class="fas fa-filter"></i> Content Type
                                </button>
                                <ul class="dropdown-menu">
                                    <li><h6 class="dropdown-header">By Content Type</h6></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('content_proviso'); return false;">Provisos (तर/Provided)</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('content_explanation'); return false;">Explanations (स्पष्टीकरण/Explanation)</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('content_numbered'); return false;">Numbered Items</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('content_lettered'); return false;">Lettered Clauses</a></li>
                                </ul>
                                
                                <button type="button" class="btn btn-outline-primary" data-bs-toggle="dropdown" title="Filter by edit status">
                                    <i class="fas fa-pencil"></i> Edit Status
                                </button>
                                <ul class="dropdown-menu">
                                    <li><h6 class="dropdown-header">By Edit Status</h6></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('empty_idno'); return false;">Empty IDNo</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('empty_remark'); return false;">Empty Remark</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('both_empty'); return false;">Both Empty</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('all_filled'); return false;">All Filled</a></li>
                                </ul>
                                
                                <button type="button" class="btn btn-outline-primary" data-bs-toggle="dropdown" title="Filter by text length">
                                    <i class="fas fa-arrows-alt-h"></i> Text Length
                                </button>
                                <ul class="dropdown-menu">
                                    <li><h6 class="dropdown-header">By Text Length</h6></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('length_short'); return false;">Short (&lt; 50 chars)</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('length_medium'); return false;">Medium (50-200 chars)</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="addFilter('length_long'); return false;">Long (&gt; 200 chars)</a></li>
                                </ul>
                            </div>
                        </div>
                        <div id="activeFilters" class="mb-2"></div>
                    </div>
                </div>
                
                <div class="text-center">
                    <button class="btn btn-success" onclick="applyFilters()" title="Apply all selected filters">
                        <i class="fas fa-check"></i> Apply Filters
                    </button>
                    <button class="btn btn-outline-secondary" onclick="clearAllFilters()" title="Remove all filters">
                        <i class="fas fa-times"></i> Clear All
                    </button>
                    <button class="btn btn-outline-secondary" onclick="resetFilters()" title="Reset to default state">
                        <i class="fas fa-undo"></i> Reset
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Output Section -->
        <div class="card" id="outputSection" style="display:none;">
            <div class="card-body">
                <h2 class="card-title">Generated Table</h2>
                
                <!-- Toolbar -->
                <div class="mb-3 d-flex flex-wrap gap-2 toolbar-section">
                    <button class="btn btn-success" onclick="copyTableToClipboard()" title="Copy table to clipboard">
                        <i class="fas fa-clipboard"></i> Copy Table
                    </button>
                    <button class="btn btn-info" onclick="exportCSV()" title="Export table as CSV">
                        <i class="fas fa-file-csv"></i> Export CSV
                    </button>
                    <button class="btn btn-info" onclick="exportJSON()" title="Export table as JSON">
                        <i class="fas fa-file-code"></i> Export JSON
                    </button>
                    <button class="btn btn-warning" onclick="addNewRow()" title="Add new empty row">
                        <i class="fas fa-plus"></i> Add Row
                    </button>
                    <button class="btn btn-outline-danger" onclick="clearOutput()" title="Clear entire table">
                        <i class="fas fa-trash"></i> Clear Table
                    </button>
                    <button class="btn btn-outline-info" onclick="printTable()" title="Print table">
                        <i class="fas fa-print"></i> Print
                    </button>
                </div>
                
                <!-- Status Bar -->
                <div class="alert alert-info" role="alert" id="statusBar">
                    <span id="rowCount">Total: 0 rows</span>
                    <span id="filterStatus" class="ms-3"></span>
                </div>
                
                <!-- Table -->
                <div class="table-responsive">
                    <table id="outputTable" class="table table-bordered table-hover table-sm">
                        <thead class="table-light sticky-top">
                            <tr>
                                <th style="width: 80px;">RowNo</th>
                                <th style="width: 150px;">IDNo</th>
                                <th>Text</th>
                                <th style="width: 200px;">Remark</th>
                                <th style="width: 80px;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <!-- Rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Application Scripts -->
    <script src="js/patterns.js"></script>
    <script src="js/language-detection.js"></script>
    <script src="js/table-generation.js"></script>
    <script src="js/search-filter.js"></script>
    <script src="js/table-operations.js"></script>
    <script src="js/export-import.js"></script>
    <script src="js/samples.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/ui-interactions.js"></script>
</body>
</html>

